@model Logistic_2.Models.LoginModel
@{
    ViewData["Title"] = "Products Management";
    var loged = User.Identity.IsAuthenticated;
    var count = ViewBag.Count;
}
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" href="~/css/myCss.css" />
<header style="width:100%">
    <a id="customButton" role="button" class="btn btn-primary" onclick="LogIn('@Url.Action("Login", "ProductsManagement")')" data-toggle="tooltip" data-placement="bottom" title="To make changes, please login!">Login</a>

    <input type="text" name="birthday" value="10/24/1984" />

    <a style="margin-bottom:10px;top: 50px; visibility: hidden" class="btn btn-success" onclick="AddingItems('@Url.Action("AddEditItem", "ProductsManagement")')"><i class="fa fa-plus" style="margin-right:10px"></i>Add item</a>
</header>
<body style="margin-top:50px;margin-bottom:100px">
    <table id="productsManagement" class="table table-striped table-bordered display" style="width:100%">
        <thead>
            <tr>
                <th class="styleTh">Name of item</th>
                <th class="styleTh">Date of production</th>
                <th class="styleTh">Best before</th>
                <th class="styleTh">Amount</th>
                <th class="styleTh">Total weight</th>
                <th class="styleTh">Category</th>
                <th class="styleTh">Container</th>
            </tr>
        </thead>
    </table>
</body>


<link href="https://cdn.datatables.net/1.10.21/css/dataTables.bootstrap4.min.css" rel="stylesheet" />
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" />
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />

@section Scripts{

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.21/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.21/js/dataTables.jqueryui.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.21/js/dataTables.bootstrap4.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/jquery/latest/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>

    <script>
        $(function () {
            $('input[name="birthday"]').daterangepicker({
                singleDatePicker: true,
                showDropdowns: true,
                minYear: 1901,
                maxYear: parseInt(moment().format('YYYY'), 10)
            }, function (start, end, label) {
                var years = moment().diff(start, 'years');
                alert("You are " + years + " years old!");
            });
        });

        var Popup, dataTable;
        $(document).ready(function () {

            daTable = $('#productsManagement').DataTable({
                dom: 'Bfrtip',
                ajax: {
                    url: '/ProductsManagement/GetData',
                    type: 'GET',
                    dataSrc: ''
                },
                rowId: 'Id',
                columns: [
                    { data: "nameOfItem", "sClass": "centering" },
                    { data: "dateOfProduction", "sClass": "centering" },
                    { data: "bestBefore", "sClass": "centering" },
                    { data: "amount", "sClass": "centering" },
                    { data: "totalWeight", "sClass": "centering" },
                    { data: "category", "sClass": "centering" },
                    { data: "container", "sClass": "centering" },
                ]
            })
        });
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })

        function SubmitForm(form) {
            $.validator.unobtrusive.parse(form);
            if ($(form).valid()) {
                $.ajax({
                    type: "POST",
                    url: form.action,
                    data: $(form).serialize(),
                    success: function (data) {
                        if (data.success) {
                            Popup.dialog('close');
                            $('#productsManagement').DataTable().ajax.reload();
                            $.notify(data.message, {
                                globalPosition: 'top center',
                                className: 'success',
                                //showDuration: 200,
                                autoHide: true,
                                autoHideDelay: 2000,
                            })
                        }
                    }
                });
            }
            return false;
        }
        function LogIn(url) {
            var formDiv = $('<div/>');
            $.get(url)
                .done(function (response) {
                    formDiv.html(response);

                    Popup = formDiv.dialog({
                        autoOpen: true,
                        modal: true,
                        draggable: false,
                        position: { my: "center", at: "top", of: window },
                        resizable: false,
                        title: 'Login',
                        height: 500,
                        width: 450,
                        close: function () {
                            $(this).closest('.ui-dialog-content').dialog('destroy').remove();
                        }
                    });
                });
        }
    </script>

}

